var E=(I,f,r)=>new Promise((o,L)=>{var c=n=>{try{p(r.next(n))}catch(g){L(g)}},x=n=>{try{p(r.throw(n))}catch(g){L(g)}},p=n=>n.done?o(n.value):Promise.resolve(n.value).then(c,x);p((r=r.apply(I,f)).next())});import{k as w,j as R,q as C,a as P,r as z,b as A,d as F}from"./element-plus-a16fcaaf.js";import{_ as J}from"./musicTable-857003fd.js";import{e as M,p as O,f as W,h as Z}from"./index-1172c018.js";import{b as $}from"./vue-router-6e50d621.js";import{Z as G,a7 as H,e as K,h as Q,n as X,o as v,c as y,a,U as d,S as m,u as e,W as i,a6 as b,P as V,a8 as N,R as Y,z as aa,O as ta}from"./@vue-b6763d16.js";import"./@element-plus-3d5ed1a4.js";import"./@vueuse-ae6f4f55.js";import"./lodash-es-9cc69f4e.js";import"./@ctrl-86a38320.js";import"./@popperjs-7c8154ca.js";import"./escape-html-8f174268.js";import"./dayjs-3c9a3002.js";import"./normalize-wheel-es-ed76fb12.js";import"./formatTime-3cb25965.js";import"./pinia-358b124a.js";import"./pinia-plugin-persist-4bd0ee57.js";import"./axios-e76ab20a.js";const sa={class:"content-section menuBar-mv"},ea={class:"m-artist"},oa={class:"artist-avatar"},na={class:"artist-name"},la={class:"artist-h2"},ia={class:"listcover"},ra={href:"javascript:;"},ca={class:"playerButton"},da={class:"tags"},ma=a("i",{class:"el-icon-date"},null,-1),pa=a("i",{class:"el-icon-date"},null,-1),_a={class:"content-section",style:{"margin-top":"0"}},ua={class:"apps-card"},va={class:"app-card__subtext"},fa={key:0,class:"app-card__footer"},wa={__name:"index",setup(I){const f=M(),r=$(),o=G({list:[],playlists:{creator:{nickname:"",avatarUrl:""}},tableData:[],activeName:"first",commList:{comments:[{user:{avatarUrl:"",nickname:""},ipLocation:{location:""}}]},loading:!0}),{list:L,playlists:c,tableData:x,activeName:p,commList:n,loading:g}=H(o);K(()=>{B()}),Q(()=>r.query.id,()=>{r.query.id&&B()});const B=()=>{o.loading=!0,X(()=>E(this,null,function*(){O(r.query.id).then(({data:_})=>{o.playlists=_.playlist,o.tableData=_.playlist.tracks.map(s=>{const u=s.ar.map(h=>h.name).join(",");return{cover:s.al.picUrl,title:s.name,singer:u,album:s.al.name,time:s.dt,id:s.id,mv:s.mv}}),o.loading=!1}),W({id:r.query.id,limit:20,offset:0}).then(({data:_})=>{o.commList=_})}))},q=()=>E(this,null,function*(){const _=o.tableData.map(t=>t.id).join(","),s=yield Z({id:_}),u=o.tableData.map((t,T)=>{const U=s.data.data.find(k=>k.id==t.id);return{title:t.title,singer:t.singer,cover:t.cover,src:U.url,time:t.time,album:t.album,id:t.id,mv:t.mv}});f.songs.push(...u);const h=f.songs.findIndex(t=>t.id==o.tableData[0].id);f.currentIndex=h});return(_,s)=>{const u=R,h=C,t=P,T=z,U=J,k=A,S=F,j=w;return v(),y("div",null,[a("div",null,[a("div",sa,[d(j,{rows:5,animated:"",loading:e(g)},{default:m(()=>[a("div",ea,[a("div",oa,[d(u,{src:e(c).coverImgUrl+"?param=250y250"},null,8,["src"])]),a("div",na,[a("h2",la,i(e(c).name),1),a("div",ia,[d(h,{size:30,src:e(c).creator.avatarUrl+"?param=60y60"},null,8,["src"]),a("a",ra,i(e(c).creator.nickname),1)]),a("div",ca,[d(t,{type:"primary",round:"",onClick:q},{default:m(()=>[b("播放全部")]),_:1})]),a("div",da,[(v(!0),y(V,null,N(e(c).tags,(l,D)=>(v(),Y(T,{class:"tags-item",key:D},{default:m(()=>[b(i(l),1)]),_:2},1024))),128))]),a("p",null,i(e(c).description),1)])]),d(S,{modelValue:e(p),"onUpdate:modelValue":s[0]||(s[0]=l=>aa(p)?p.value=l:null)},{default:m(()=>[d(k,{name:"first"},{label:m(()=>[a("span",null,[ma,b(" 歌单("+i(e(c).trackIds.length)+")",1)])]),default:m(()=>[d(U,{data:e(x)},null,8,["data"])]),_:1}),d(k,{name:"second"},{label:m(()=>[a("span",null,[pa,b(" 评论("+i(e(n).total)+")",1)])]),default:m(()=>[a("div",_a,[a("div",ua,[(v(!0),y(V,null,N(e(n).comments,(l,D)=>(v(),y("div",{class:"app-card usercom",key:D},[a("span",null,[d(u,{class:"useravatar",src:l.user.avatarUrl+"?param=32y32",alt:""},null,8,["src"]),b(" "+i(l.user.nickname),1)]),a("div",va,i(l.content),1),l.ipLocation.location?(v(),y("div",fa,[a("span",null,"IP:"+i(l.ipLocation.location),1),a("span",null,i(l.timeStr),1)])):ta("",!0)]))),128))])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["loading"])])])])}}};export{wa as default};
