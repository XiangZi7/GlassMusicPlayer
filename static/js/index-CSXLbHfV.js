import{u as e,i as a,n,a as t,t as i,b as r,c as l}from"./index-CIXfVFMw.js";import{r as u,A as o,C as s,W as c,o as v,Q as g}from"./index-CHp3xzic.js";function m(e){var a;const n=i(e);return null!=(a=null==n?void 0:n.$el)?a:n}const p=a?window:void 0,h=a?window.navigator:void 0;function d(e){const a=function(){const e=u(!1),a=g();return a&&v((()=>{e.value=!0}),a),e}();return s((()=>(a.value,Boolean(e()))))}function f(e={}){const{navigator:a=h}=e,l=["chargingchange","chargingtimechange","dischargingtimechange","levelchange"],s=d((()=>a&&"getBattery"in a&&"function"==typeof a.getBattery)),c=u(!1),v=u(0),g=u(0),f=u(1);let y;function w(){c.value=this.charging,v.value=this.chargingTime||0,g.value=this.dischargingTime||0,f.value=this.level}return s.value&&a.getBattery().then((e=>{y=e,w.call(y),function(...e){let a,l,u,s;if("string"==typeof e[0]||Array.isArray(e[0])?([l,u,s]=e,a=p):[a,l,u,s]=e,!a)return n;Array.isArray(l)||(l=[l]),Array.isArray(u)||(u=[u]);const c=[],v=()=>{c.forEach((e=>e())),c.length=0},g=o((()=>[m(a),i(s)]),(([e,a])=>{if(v(),!e)return;const n=t(a)?{...a}:a;c.push(...l.flatMap((a=>u.map((t=>((e,a,n,t)=>(e.addEventListener(a,n,t),()=>e.removeEventListener(a,n,t)))(e,a,t,n))))))}),{immediate:!0,flush:"post"}),h=()=>{g(),v()};r(h)}(y,l,w,{passive:!0})})),{isSupported:s,charging:c,chargingTime:v,dischargingTime:g,level:f}}function y(a={}){const n=u(),t=d((()=>"undefined"!=typeof performance&&"memory"in performance));if(t.value){const{interval:t=1e3}=a;e((()=>{n.value=performance.memory}),t,{immediate:a.immediate,immediateCallback:a.immediateCallback})}return{isSupported:t,memory:n}}function w(e,a={}){const{pitch:n=1,rate:t=1,volume:v=1,window:g=p}=a,m=g&&g.speechSynthesis,h=d((()=>m)),f=u(!1),y=u("init"),w=l(e||""),A=l(a.lang||"en-US"),S=c(void 0),k=e=>{e.lang=i(A),e.voice=i(a.voice)||null,e.pitch=i(n),e.rate=i(t),e.volume=v,e.onstart=()=>{f.value=!0,y.value="play"},e.onpause=()=>{f.value=!1,y.value="pause"},e.onresume=()=>{f.value=!0,y.value="play"},e.onend=()=>{f.value=!1,y.value="end"},e.onerror=e=>{S.value=e}},b=s((()=>{f.value=!1,y.value="init";const e=new SpeechSynthesisUtterance(w.value);return k(e),e}));return h.value&&(k(b.value),o(A,(e=>{b.value&&!f.value&&(b.value.lang=e)})),a.voice&&o(a.voice,(()=>{m.cancel()})),o(f,(()=>{f.value?m.resume():m.pause()}))),r((()=>{f.value=!1})),{isSupported:h,isPlaying:f,status:y,utterance:b,error:S,stop:()=>{m.cancel(),f.value=!1},toggle:(e=!f.value)=>{f.value=e},speak:()=>{m.cancel(),b&&m.speak(b.value)}}}export{y as a,f as b,w as u};
